# 二次型及其标准形、规范形
## 二次型
对于二次型 $f = x^T A x$ ，而言，当
1. $A$ 是对角阵时，是标准二次型
2. $A^T = A$，$A$ 非对角阵时，是不标准二次型

在标准形中若平方项系数只有 $1$，$-1$，$0$ 时，即
$$
f(x_1, x_2, \cdots, x_n) = x^TAx = x^2_1 + x^2_2 + \cdots + x^2_p - x^2_{p + 1} - \cdots x^2_{p + q}
$$
称其为二次型的规范形。
 
**Notes：** 标准形不唯一，但规范形唯一。
# 矩阵合同
如果 $A、B$ 为 $n$ 阶矩阵，若存在可逆矩阵 $P$，使得
$$
P^T A P =B
$$
则称两个矩阵 $A、B$ 合同。

## 判断合同的方法
判断两个矩阵 $A, B$ 合同的方法主要有两个：（实对称）
1. 直接使用定义，找到一个可逆阵 $C$，使得 $C^TAC = B$
2. $x^TAx$ 和 $x^TBx$ 有相同的正、负惯性系数 


# 二次型标准化的过程
## 配方法标准过程
设 $f(x_1, x_2) = x^2_1 - 2 x_1 x_2 - 3 x_2^2$，将其标准化
$$
A = 
\begin{bmatrix}
        1 & -1\\
    -1 & -3 \\
\end{bmatrix}
\quad 
x = 
\begin{bmatrix}
    x_1 \\
    x_2 \\
\end{bmatrix}
\quad
f = x^T A x
$$
由配方法可以知道：
$$
f = (x_1 - x_2)^2 - 4x^2_2
$$
令
$$
\begin{cases}
    x_1 - x_2 = y_1 \\
    x_2 = y_2
\end{cases}
\Rightarrow
\begin{cases}
    x_1 = y_1 + y_2 \\
    x_2 = y_2 \\
\end{cases}
$$
也就是 $X = PY$，$P =\begin{bmatrix}1 & 1\\0 & 1\\\end{bmatrix}$ 可逆。

$$
f = X^TAX \overset{X = PY}{=} Y^T (P^T A P) Y = y_1^2 - 4y^2_2
$$


**Notes:**
1. 配方法二次型有无数个标准形
2. 标准形系数不一定为 $A$ 的特征值


**配方法的一些技巧：**

配方法的顺序一般是按照逐个变量来配，一个一个配完。

例如：
$$
\begin{aligned}
f\left(x_{1}, x_{2}, x_{3}\right) &=x_{1}^{2}+3 x_{2}^{2}+3 x_{3}^{2}+2 x_{1} x_{2}-4 x_{1} x_{3} \\
&=x_{1}^{2}+2 x_{1}\left(x_{2}-2 x_{3}\right)+\left(x_{2}-2 x_{3}\right)^{2}+3 x_{2}^{2}+3 x_{3}^{2}-\left(x_{2}-2 x_{1}\right)^{2} \\
&=\left(x_{1}+x_{2}-2 x_{3}\right)^{2}+2 x_{2}^{2}+4 x_{2} x_{3}-x_{3}^{2} \\
&=\left(x_{1} \div x_{2}-2 x_{3}\right)^{2}+2\left(x_{2}+x_{3}\right)^{2}-3 x_{3}^{2}
\end{aligned}
$$

如果遇到没有平方项的，直接和差换元，如：
$$
\begin{aligned}
f\left(x_{1}, x_{2}, x_{3}\right) &=2 x_{1} x_{2}+4 x_{1} x_{3} \\
&=2\left(y_{1}+y_{2}\right)\left(y_{1}-y_{2}\right)+4\left(y_{1}+y_{2}\right) y_{3} \\
&=2 y_{1}^{2}-2 y_{2}^{2}+4 y_{1} y_{3}+4 y_{2} y_{3} \\
&=2 y_{1}^{2}+4 y_{1} y_{3}+2 y_{3}^{2}-2 y_{2}^{2}+4 y_{2} y_{3}-2 y_{3}^{2} \\
&=2\left(y_{1}+y_{3}\right)^{2}-2\left(y_{2}-y_{3}\right)^{2}
\end{aligned}
$$

## 正交变换法
1. $f = x^TAx$，$A^T = A$ 
2. $|\lambda E -A| = 0 \Rightarrow \lambda_1, \lambda_2, \cdots \lambda_n$
3. $(\lambda_i E - A) x = 0 \Rightarrow \alpha_1, \alpha_2, \cdots \alpha_n$ 
4. $\alpha_1, \alpha_2, \cdots \alpha_n \Rightarrow \gamma_1, \gamma_2, \cdots \gamma_n$   
   
   令 $Q = (\gamma_1, \gamma_2, \cdots \gamma_n)$，$Q^TQ = E$。

   $$
   AQ = Q 
   \begin{bmatrix}
       \lambda_1 &0 &\cdots &0 \\
       0 &\lambda_2 &\cdots &0 \\
       \vdots &\vdots &\ddots &\vdots \\
       0 &0 &\cdots &\lambda_n \\
   \end{bmatrix}
   \Rightarrow
   Q^TAQ = 
   \begin{bmatrix}
       \lambda_1 & & \\
       &\ddots & \\
       & &\lambda_n\\
   \end{bmatrix}
   $$
5. $f = X^TAX \overset{X = QY}{=} Y^T (Q^T A Q) Y = \lambda_1 y_1^2 + \lambda_2 y_2^2 + \cdots + \lambda_n y_n^2$

**Notes:** 正交变换法标准形一定是特征值且唯一。

# 正定二次型
## 定义
对于任意的非零向量 $x = (x_1, x_2, \cdots, x_n)^T$， 恒有：
$$
f(x_1, x_2, \cdots, x_n) = x^TAx > 0
$$
则称二次型 $f$ 为正定二次型，对应的矩阵为正定矩阵。
## 判别法
1. 定义法：对于 $\forall x \neq 0$，$x^{T} A x>0$  
2. 特征值法：若 $A$ 是一个 $n \times n$ 的矩阵，且 $A^T = A$ 则 $A$ 正定 $\Leftrightarrow \lambda_1 > 0, \lambda_2 > 0, \cdots \lambda_n > 0$
3. 二次型 $x^\mathrm{T} A X$ 为正定二次型的充要条件是 $A$ 的顺序主子式都大于零，也就是：
$$
a_{11} > 0, 
\begin{vmatrix}
a_{11} & a_{12} \\ 
a_{21} & a_{22} \\ 
\end{vmatrix} > 0, 
\left| A \right| > 0
$$
3. 设 $A^\mathrm{T} = A$，则 $A$ 为正定矩阵的充要条件是存在可逆矩阵 $B$，使得 $A = B^\mathrm{T}B$。
4. 设 $A^\mathrm{T} = A$，则 $A$ 为正定矩阵的充要条件是 $A$ 与 $E$ 合同
5. 设 $A^\mathrm{T} = A$，则 $A$ 为正定矩阵的充要条件是 $A$ 的正惯性系数为 $n$
6. 设 $A, B$ 分别为 $m$ 和 $n$ 阶实对称矩阵，则 $\begin{pmatrix} A & 0 \\ 0 & B \\ \end{pmatrix}$ 为正定矩阵的充要条件是 $A, B$ 都是正定矩阵。 


其他条件
1. 二次型 $f(X) = X^\mathrm{T}AX$ 正定的必要条件是：$a_{ii} > 0(i = 1, 2, \cdots, n); \left| A \right| > 0$。
2. 若 $A$ 是正定矩阵，则 $A$ 一定是可逆矩阵
3. 若 $A$ 是正定矩阵，则 $A^{-1}$ 以及 $A^*$ 是正定矩阵
4. 若 $A, B$ 都是正定矩阵，则 $A + B$ 是正定矩阵。


# 等价、相似、合同
等价只要求两个矩阵的秩相同。

相似与合同之间的关系不是很大，引用知乎的理解，为：
> 相似的矩阵是同一个线性变换在不同基下的矩阵。  
> 合同的矩阵是同一个双线性形在不同基下的矩阵。

一般而言，证明两矩阵合同是困难的，他只有两个充要条件，一是定义，二是二次型正负惯性系数相同。  
两矩阵相似代表两矩阵特征值相同，能否代表它们的正负惯性系数相同呢？答案是不一定。因为没法保证两个矩阵是否相似于对角阵。但在实际做题中，所遇到的矩阵一般是实对称矩阵，所以必定能相似对角化。  
所以若两个实对称矩阵相似，那么它们特征值相同且构成对角阵，构成了标准型系数，正负惯性指数相同，也就是它们必定合同。

# 二次型最值问题
设 $f(x_1, x_2, \cdots, x_n) = x^\mathrm{T}Ax$，且 $A$ 的特征值为 $\lambda_1 \le \lambda_2 \le \cdots \le \lambda_n$，证明当 $\left| x \right| = 1$ 时，$\lambda_1\le x^\mathrm{T}Ax \le \lambda_n$。

因为 $A^\mathrm{T}A$，所以存在正交矩阵 $Q$，使得
$$
x^\mathrm{T}Ax = y^\mathrm{T}(Q^\mathrm{T}AQ)y = \lambda_1y_1^2 + \lambda_2y_2^2 + \cdots + \lambda_ny_n^2
$$
再由 $\lambda_1 \le \lambda_2 \le \cdots \le \lambda_n$ 得
$$
\lambda_1(y_1^2 + y_2^2 + \cdots + y_n^2) \le x^\mathrm{T}Ax \le \lambda_n(y_1^2 + y_2^2 + \cdots + y_n^2)
$$
因为 $Q$ 为正交矩阵，所以
$$
\left| y \right| = y^\mathrm{T}y = x^\mathrm{T}Q^\mathrm{T}Qx = x^\mathrm{T}x = \left| x \right|
$$
从而当 $\left| x \right| = 1$ 时，$\left| y \right| = 1$，即 $\sqrt{y_1^2 + y_2^2 + \cdots + y_n^2} = 1$，
故当 $\left| x \right| = 1$ 时，$\lambda_1 \le x^\mathrm{T}Ax \le \lambda_n$。 

当且仅当
1. $y = (0, 0, \cdots, 1)^\mathrm{T}$ 时，也就是 $x = Q^{-1}y$ 时，$f$ 取得最大值。
2. $y = (1, 0, \cdots, 0)^\mathrm{T}$ 时，也就是 $x = Q^{-1}y$ 时，$f$ 取得最小值。