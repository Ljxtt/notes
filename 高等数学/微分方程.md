# 微分方程

## 可分离变量的微分方程

$$
\begin{aligned}
   \frac{ \mathop{}\!\mathrm{d} y}{ \mathop{}\!\mathrm{d} x}=f(x,y)&=\varphi_1(x)\varphi_2(y)\\
\frac{ \mathop{}\!\mathrm{d} y}{\varphi_2(y)}&=\varphi_1(x) \mathop{}\!\mathrm{d} x
\end{aligned}
$$

## 齐次微分方程

形如以下形式的微分方程为齐次微分方程
$$
\frac{ \mathop{}\!\mathrm{d} y}{ \mathop{}\!\mathrm{d} x}=f(x,y)=\varphi(\frac yx)
$$
令 $u=\dfrac yx$ ，则 $\dfrac{ \mathop{}\!\mathrm{d} y}{ \mathop{}\!\mathrm{d} x}=u+x\dfrac{ \mathop{}\!\mathrm{d} u}{ \mathop{}\!\mathrm{d} x}$，代入得
$$
u+x\frac{ \mathop{}\!\mathrm{d} u}{ \mathop{}\!\mathrm{d} x}=\varphi(u)
$$

## 一阶齐次线性微分方程

形如以下形式的微分方程成为一阶齐次线性微分方程
$$
\frac{ \mathop{}\!\mathrm{d} y}{ \mathop{}\!\mathrm{d} x} +P(x)y=0
$$
可以手动计算，也可以背通解
$$
y=Ce^{-\int-P(x) \mathop{}\!\mathrm{d} x}
$$

## 一阶非齐次线性微分方程

形如以下形式的微分方程成为一阶非齐次线性微分方程
$$
\frac{ \mathop{}\!\mathrm{d} y}{ \mathop{}\!\mathrm{d} x} +P(x)y=Q(x)
$$
可以手算：得出对应齐次方程的通解后，令$C=u(x)$, 将含$u(x)$的解代回原方程求$u(x)$，进而得到原非齐次方程的解。也可以背通解
$$
y=\left[\int Q(x)e^{\int P(x) \mathop{}\!\mathrm{d} x} \mathop{}\!\mathrm{d} x+C\right]e^{-\int P(x) \mathop{}\!\mathrm{d} x}
$$
## 伯努利方程

形如以下形式
$$
\frac{ \mathop{}\!\mathrm{d} y}{ \mathop{}\!\mathrm{d} x} +P(x)y=Q(x)y^n
$$
令$x=y^{1-n}$，代入得
$$
\frac{\mathrm dz}{ \mathop{}\!\mathrm{d} x} +(1-n)P(x)z=(1-n)Q(x)
$$

## 可降阶的形式

1. $y^{(n)}=f(x)$可通过积分降阶

2. $f(x,y',y'')=0$，令 $y'=\dfrac{ \mathop{}\!\mathrm{d} y}{ \mathop{}\!\mathrm{d} x}=p$，则 $y''=\dfrac{\mathrm dp}{ \mathop{}\!\mathrm{d} x}$，化为 $f(x,p,\dfrac{\mathrm dp}{ \mathop{}\!\mathrm{d} x})=0$，解出 $p=\varphi(x,C_1)$

3. $f(y,y',y'')=0$，令 $y'=p$，则 $y''=\dfrac{\mathrm dp}{ \mathop{}\!\mathrm{d} y}\dfrac{ \mathop{}\!\mathrm{d} y}{ \mathop{}\!\mathrm{d} x}=y\dfrac{\mathrm dp}{ \mathop{}\!\mathrm{d} y}$，代入方程即可解出

## 二阶线性微分方程

$$
y''+py'+q=0/f(x)
$$

求解的过程如下

1. 求特征方程 $\lambda^2+p\lambda+q=0$

2. 当特征方程有两不重根时，$y=C_1e^{\lambda_1x}+C_2e^{\lambda_2x}$

   当特征方程有重根时，$y=(C_1+C_2x)e^{\lambda x}$

   当特征方程有共轭根时，$y=e^{\alpha x}(C_1\cos\beta x+C_2\sin\beta x)$

3. 对于高阶的情况，只需把特征根的情况组合即可

4. 求特解

   1. $f(x)=P_n(x)e^{kx}$

      若k不为特征值，令 $y_0=(a_0+a_1x+\dots+a_nx^n)e^{kx}$

      若k与一组n重特征值相同，令 $y_0=x^n(a_0+a_1x+a_nx^n)e^{kx}$

   2. $f(x)=e^{\alpha x}[P_t(x)\cos\beta x+P_s(x)\sin\beta x]$

      若 $\alpha+i\beta$ 不为特征值，令 $y_0=e^{\alpha x}[Q_n(x_1)\cos\beta x+Q_n(x_2)\sin\beta x]$

      若是，则令$y_0'=xy_0$

## 求解特解的快速方法——微分算子法

若按照原始的方法计算，需要将设好的特解代回原方程，非常容易出错。微分算子法引入一种微分算子 $D=\frac{d}{dx}$，虽然经不起严格证明的推敲，但是仍然是非常实用的方法，它的本质即为拉普拉斯变换。微分算子法也分几种情况。

1. $f(x)=P(x)$ 即为一个多项式时，设 $y^*=\frac1{P(D)}f(x)$，其中 $P(D)$ 为以 $D$ 为变量的特征方程。对分母进行因式分解，然后进行无穷级数展开，展开后的级数只有 $P(x)$ 的最高阶及更低阶项非 $0$，整理后便得特解。

2. $f(x)=e^{kx}$ 且 $k$ 不为特征根时，设 $y^*=\frac1{P(D)}e^{kx}=\frac1{P(k)}e^{kx}$ 即把 $k$ 代入 $P(D)$ 当中即可求得。若代入发现分子为 $0$，则说明有特征根，需按第4点处理。

3. $f(x)=e^{kx}u(x)$ 时，设 $y^*=\frac1{P(D)}e^{kx}u(x)=e^{kx}\frac1{P(D+k)}u(x)$，然后将分母因式分解，级数展开，对 $u(x)$ 求导后即得特解。

4. $f(x)=e^{kx}$ 且 $k$ 是 $m$ 重特征根时，设 $y^*=\frac1{P(D)}e^{kx}=x^m\frac1{P^{(m)}(D)}e^{kx}$，经过同样的步骤后求得特解。

5. $f(x)=\cos ax$ 或者 $f(x)=\sin ax$ 时，设$y^*=\frac1{P(D)}\cos ax$，将 $P(D)$ 中的 $D^2$ 用 $-a^2$ 代替计算即可。当遇到分母为 $0$ 的情况时，说明有特征根，需要将 $P(D)$ 求导一次，且多乘一个 $x$，对 $\sin$ 或 $\cos$ 积分即得特解。

还有一个更直接的办法：直接求出在代入法下通解所满足的方程，利用多项式相等求出。

1. $f(x)=e^{kx}p_n(x)$ 时，设 $y^*=x^kQ(x)e^{kx}=S(x)e^{kx}$，其中 $S(x)=x^kQ(x)$。则 $S(x)$ 满足的方程为
   $$
   S''(x)+(2k+p)S'(x)+(k^2+kp+p)S(x)=p_n(x)
   $$
   因此，由假设求出 $S(x)$ ，代入上述方程，即可求出特解。

2. $f(x)=e^{\lambda x}[P_l(x)\cos\omega x+P_n(x)\sin\omega x]$，设$y^*=x^ke^{\lambda x}[P_1(x)\cos\omega x+P_2(x)\sin\omega x]=S(x)e^{kx}$，方法与前一致。

## 欧拉方程

$$
x^ny^{(n)}+a_{n-1}x^{n-1}y^{(n-1)}+\dots+a_1xy'+a_0y=f(x)
$$

令 $x=e^t$，则 $\displaystyle x^ky^{(k)}=\prod\limits_{i=1}^{k-1}(\mathrm D-i)y$，代入方程即可化为常系数方程。特别地，
$$
\begin{aligned}
   x^3y''' &=\dfrac{\mathrm d^3y}{\mathrm dt^3}-3\dfrac{\mathrm d^2y}{\mathrm dt^2}+2\dfrac{ \mathop{}\!\mathrm{d} y}{\mathrm dt} \\

   x^2y'' &=\dfrac{\mathrm d^2y}{\mathrm dt^2}-\dfrac{ \mathop{}\!\mathrm{d} y}{\mathrm dt}\\

   xy' &=\dfrac{ \mathop{}\!\mathrm{d} y}{\mathrm dt}
\end{aligned}
$$


## 注意事项

1. 若 $\mathop{}\!\mathrm{d} x$，$\mathop{}\!\mathrm{d} y$ 带有互不齐次的多项式，则往线性方程化；带有互为齐次的多项式，则往齐次方程方向化。

2. 若当前形式下主要的部分都在分母，可以两边取倒，改为求 $x$ 对 $y$ 的函数，实际上等价。

3. 若出现多项式的非 $1$ 次幂 $P_n(x,y)$，$n\ne 1$ 且 $n>0$，则以 $u=P(x,y)$ 换元。

4. 一些在积分使用的换元法也可以使用。

   1. 若出现 $1-x^2$ 的项，可以考虑 $x=\sin t$

   2. 若出现 $e^P(x)$ 的项，可以考虑 $x=\ln t$

   3. 如某一部分频繁出现，则可以试着将其对应的导数扔进 $\mathop{}\!\mathrm{d}$ 中。

      典型例子：$\cos y\dfrac{ \mathop{}\!\mathrm{d} y}{ \mathop{}\!\mathrm{d} x}-\cos x\sin^2y=\sin y$

5. 若 $\mathop{}\!\mathrm{d} x$，$\mathop{}\!\mathrm{d} y$ 带有不可拆分的复杂多项式，可以用全微分方程，使用时需注意路径无关的条件。

6. 如何从非齐次方程的特解中找出齐次方程的解？
   
   这种问题一般都会给出三个解，而由解叠加定理，两解相加为新解，而两解相减即为齐次方程的解。
   
   再者，齐次方程的通解具有 $y=C_1e^{k_1x}+C_2e^{k_2x}$或$y=Cxe^{kx}$ 的形式，如果发现已经推出有一个单特征根，那么另外表双特征根的解为特解，将其从给定的解中去掉即为另一个单特征根。
   
   求出非齐次方程的左边后要求右边，一种办法是用前面已知的特解代入方程然后得出右边，也可以反向利用7.5节的方法，由特解设右边的形式，然后利用快速方法求得。